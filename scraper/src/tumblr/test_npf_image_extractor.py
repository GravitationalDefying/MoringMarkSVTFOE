from unittest import TestCase

from src.tumblr.npf_image_extractor import extract_image_urls


class PostImageExtractionTestCase(TestCase):
    def test_extracts_images(self):
        raw_body = """
<div class="npf_row"><figure class="tmblr-full" data-orig-height="1085" data-orig-width="873"><img src="https://64.media.tumblr.com/a1cf594b2b24935cf5155a926270fb97/e511e8776438850c-00/s640x960/61f736894c0470f938fb10cb28f65bd588fd91da.png" data-orig-height="1085" data-orig-width="873" srcset="https://64.media.tumblr.com/a1cf594b2b24935cf5155a926270fb97/e511e8776438850c-00/s75x75_c1/6faae57aef160ee8b777fb3a8490d822342affe7.png 75w, https://64.media.tumblr.com/a1cf594b2b24935cf5155a926270fb97/e511e8776438850c-00/s100x200/b8a0c692656c6fdbba6094c79417950a39b37641.png 100w, https://64.media.tumblr.com/a1cf594b2b24935cf5155a926270fb97/e511e8776438850c-00/s250x400/a78afd4e6adff7549466d7674ea2076737158078.png 250w, https://64.media.tumblr.com/a1cf594b2b24935cf5155a926270fb97/e511e8776438850c-00/s400x600/a1284e2fe7387c665e57acc36ef8669e01e852b0.png 400w, https://64.media.tumblr.com/a1cf594b2b24935cf5155a926270fb97/e511e8776438850c-00/s500x750/0670d5e17c3bf45c337abee7dcdc963c1ad23706.png 500w, https://64.media.tumblr.com/a1cf594b2b24935cf5155a926270fb97/e511e8776438850c-00/s540x810/e12c5420c97c58a00311e56237eebd7aceb69a16.png 540w, https://64.media.tumblr.com/a1cf594b2b24935cf5155a926270fb97/e511e8776438850c-00/s640x960/61f736894c0470f938fb10cb28f65bd588fd91da.png 640w, https://64.media.tumblr.com/a1cf594b2b24935cf5155a926270fb97/e511e8776438850c-00/s1280x1920/dad944e13d56b36f4b6908fc78bae7741dd1e7d1.png 873w" sizes="(max-width: 873px) 100vw, 873px"/></figure></div><div class="npf_row"><figure class="tmblr-full" data-orig-height="1085" data-orig-width="873"><img src="https://64.media.tumblr.com/3a452e305533e092b774e4b8bb6f51d9/e511e8776438850c-76/s640x960/cdfbcb7192eadc0e997b398243b38b48631e763f.png" data-orig-height="1085" data-orig-width="873" srcset="https://64.media.tumblr.com/3a452e305533e092b774e4b8bb6f51d9/e511e8776438850c-76/s75x75_c1/975696be324d28814e29e3eb98df17095a2ff3bd.png 75w, https://64.media.tumblr.com/3a452e305533e092b774e4b8bb6f51d9/e511e8776438850c-76/s100x200/18cfa0f95dc372a3aca2ac88bb6f566de2eb38ec.png 100w, https://64.media.tumblr.com/3a452e305533e092b774e4b8bb6f51d9/e511e8776438850c-76/s250x400/8664cccc05fcb00a6c7eef468c4420456d065fb0.png 250w, https://64.media.tumblr.com/3a452e305533e092b774e4b8bb6f51d9/e511e8776438850c-76/s400x600/4e41b8e8304b47c4b7a65530e87ced8f0695c475.png 400w, https://64.media.tumblr.com/3a452e305533e092b774e4b8bb6f51d9/e511e8776438850c-76/s500x750/1030c7944dac9a6558bb348d45beb8ca1fe6ebd9.png 500w, https://64.media.tumblr.com/3a452e305533e092b774e4b8bb6f51d9/e511e8776438850c-76/s540x810/d221338e7ab149b61f4de4ac6051edcea28330ee.png 540w, https://64.media.tumblr.com/3a452e305533e092b774e4b8bb6f51d9/e511e8776438850c-76/s640x960/cdfbcb7192eadc0e997b398243b38b48631e763f.png 640w, https://64.media.tumblr.com/3a452e305533e092b774e4b8bb6f51d9/e511e8776438850c-76/s1280x1920/0b7580db9ce418d6115a861c44fff8dad63dc2e8.png 873w" sizes="(max-width: 873px) 100vw, 873px"/></figure></div><div class="npf_row"><figure class="tmblr-full" data-orig-height="1085" data-orig-width="873"><img src="https://64.media.tumblr.com/fa44165386a2b50579d8c6b79077f94c/e511e8776438850c-96/s640x960/b7cf6f4e262650eb33d578a1b316017d5184a844.png" data-orig-height="1085" data-orig-width="873" srcset="https://64.media.tumblr.com/fa44165386a2b50579d8c6b79077f94c/e511e8776438850c-96/s75x75_c1/8671882bb8abf71b40f8dbc7797b6250bc84f757.png 75w, https://64.media.tumblr.com/fa44165386a2b50579d8c6b79077f94c/e511e8776438850c-96/s100x200/7fe9b598eada2512ad685b9c52722c44b299f448.png 100w, https://64.media.tumblr.com/fa44165386a2b50579d8c6b79077f94c/e511e8776438850c-96/s250x400/c5c0f4f8180d26646fa00305a45ea8fdbb71fa0f.png 250w, https://64.media.tumblr.com/fa44165386a2b50579d8c6b79077f94c/e511e8776438850c-96/s400x600/880b7f73801ad35690a41b6f8c6838ce191a38c5.png 400w, https://64.media.tumblr.com/fa44165386a2b50579d8c6b79077f94c/e511e8776438850c-96/s500x750/1fbc697d575ccecf6980b9f81b2a600a4610754b.png 500w, https://64.media.tumblr.com/fa44165386a2b50579d8c6b79077f94c/e511e8776438850c-96/s540x810/dec189710cc281c5d06dc948eaa76355ccaba0b5.png 540w, https://64.media.tumblr.com/fa44165386a2b50579d8c6b79077f94c/e511e8776438850c-96/s640x960/b7cf6f4e262650eb33d578a1b316017d5184a844.png 640w, https://64.media.tumblr.com/fa44165386a2b50579d8c6b79077f94c/e511e8776438850c-96/s1280x1920/3d7e2a5a08df06677587467132e84938ddcdf9e3.png 873w" sizes="(max-width: 873px) 100vw, 873px"/></figure></div>
        """
        result = extract_image_urls(raw_body)
        self.assertEqual(
            list(result),
            [
                "https://64.media.tumblr.com/a1cf594b2b24935cf5155a926270fb97/e511e8776438850c-00/s640x960/61f736894c0470f938fb10cb28f65bd588fd91da.png",
                "https://64.media.tumblr.com/3a452e305533e092b774e4b8bb6f51d9/e511e8776438850c-76/s640x960/cdfbcb7192eadc0e997b398243b38b48631e763f.png",
                "https://64.media.tumblr.com/fa44165386a2b50579d8c6b79077f94c/e511e8776438850c-96/s640x960/b7cf6f4e262650eb33d578a1b316017d5184a844.png",
            ],
        )
